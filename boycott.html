<!DOCTYPE html>
<html lang="en" data-theme="night">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Boycott View</title>
    <meta
      name="description"
      content="Boycott Single View page."
    />
    <!-- <link rel="stylesheet" href="theme.css" /> -->
    <link rel="stylesheet" href="boycott.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>
  </head>
  <body>
    <!-- logo and nav bar -->
    <div class="navigation">
      <img src="alignLogo.png" alt="Logo" style="width:100px;height:100px;">
        <div id="nav"><strong><a href=""><strong>Home</strong></a></strong></div>
        <div id="nav"><strong><a href=""><strong>Boycotts</strong></a></strong></div>
    </div>
    <!-- header/boycott name -->
    <section id="top">
        <h1>Coding is an addiction!<h1>
    </section>
    <!-- contributor name and personal details -->
    <section id="main">
        <span class="dot">D</span>  <p><a href="">Dane Joe</a></p>
        <br>
      <h6>Member since: November 10, 2022 | Date Posted: November 10, 2022</h6>
      <!-- table with boycott details for each contributor entry -->
      <div class="info">

        <table id="details">
          <tr>
            <th>Title:</th>
            <th id="boycott-title">Title</th>
         </tr>
          <!-- the company name to boycott -->
            <tr>
              <td>Company:</td>
              <td id="company-name">Company name </td>
            </tr>
            <!-- the person/people who established or "called" the boycott -->
            <tr>
               <td>Boycott Author:</td>
               <td id="author-name">Author name</td>
            </tr>
            <!-- the date the boycott was first called -->
              <tr>
               <td >Boycott Creation Date:</td>
               <td id="create-date">Date</td>
            </tr>
            <!-- social media links or email addresses where the boycotted company can be contacted -->

            <!-- A link to other boycotts in our database pulled from the same category -->

          </table>
          <!-- the content of the boycott goes here -->
    <section id="post">
        <p id="boycott-description"></p>
        <br>
        <br>
        <br>
        <button id="edit-boycott">Edit</button>
      </div>
      <div class="popup">
        <div class="popup-content">
          <img src="images/close.png" alt="close" class="close">
          <p>Edit Boycott</p>
          <br>
          <br>          
          <label>Title: <input type="text" id="pu-boycott-title"></label>
          <label>Company: <input type="text" id="pu-company"></label>
          <label>Description: <textarea id="pu-description"></textarea></label>
          <button id="save-editted-boycott">Save</button>
        </div>
      </div>
      </section>
      <script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.14.0/firebase-app.js";
import {
  getFirestore,
  collection,
  doc,
  addDoc,
  getDoc,
  updateDoc,
  deleteDoc,
  setDoc,
} from "https://www.gstatic.com/firebasejs/9.14.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyBdwtAPwaM9mqHMXSrobtiWRGjLUidz6as",
  authDomain: "align-d4038.firebaseapp.com",
  projectId: "align-d4038",
  storageBucket: "align-d4038.appspot.com",
  messagingSenderId: "540706810436",
  appId: "1:540706810436:web:b05f6cdd7736a5405b2a11",
  measurementId: "G-NS4V9CKKD3",
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
//doc elements
var grabButton = document.getElementById("grab-boycott")
//boycott view fields
var viewBoycottTitle = document.getElementById("boycott-title");
var viewBoycottCompany = document.getElementById("company-name");
var viewAuthorName = document.getElementById("author-name");
var viewCreateDate = document.getElementById("create-date");
var viewDescription = document.getElementById("boycott-description");

//popup view fields
var popBoycottTitle = document.getElementById("pu-boycott-title");
var popCompanyName = document.getElementById("pu-company");
var popDescription = document.getElementById("pu-description");



//event listeners
document.getElementById("edit-boycott").addEventListener("click", editPopup);
document.getElementById("save-editted-boycott").addEventListener("click", saveEdittedBoycott);
document.querySelector(".close").addEventListener("click", closePopup);

//Populate Boycott View and Popup Views
getBoycott();


//functions


async function getBoycott() {

const docRef = doc(db, "boycottTest", "v0ekywdRHoTDOmNb40tb");
const docSnap = await getDoc(docRef);
const data = docSnap.data();

let boycottTitle = data.title;
let boycottCompany = data.companyName;
let authorName = data.authorName;
let date = data.date;
let description = data.desc

viewBoycottTitle.innerHTML = boycottTitle;
viewBoycottCompany.innerHTML = boycottCompany;
viewAuthorName.innerHTML = authorName;
viewCreateDate.innerHTML = date;
viewDescription.innerHTML = description;





popBoycottTitle.value = boycottTitle;
popCompanyName.value = boycottCompany;
popDescription.value = description;
    
  }

function editPopup(){
  document.querySelector(".popup").style.display = "flex";
}

function closePopup(){
  document.querySelector(".popup").style.display = "none";
}


async function saveEdittedBoycott(){
    await setDoc(doc(db, "boycottTest", "v0ekywdRHoTDOmNb40tb"), {
      //include if else for user editting = author


      
      title: popBoycottTitle.value,
      companyName: popCompanyName.value,
      desc: popDescription.value,
  

    //close popup window
    //run getboycott() to update values
    
},
{merge:true}
);

closePopup();
getBoycott();

  }
      </script>
  </body>
</html>